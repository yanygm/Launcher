using System;
using System.Text;

namespace KartLibrary.Encrypt;

public class Rho5KeyProvider
{
    public uint[] var_0 = new uint[20];

    public uint[] var_1 = new uint[16];

    public int curSubPos;

    private static uint[,] const_1 = new uint[6, 256]
    {
        {
            3332727651u, 4169432188u, 4003034999u, 4136467323u, 4279104242u, 3602738027u, 3736170351u, 2438251973u, 1615867952u, 33751297u,
            3467208551u, 1451043627u, 3877240574u, 3043153879u, 1306962859u, 3969545846u, 2403715786u, 530416258u, 2302724553u, 4203183485u,
            4011195130u, 3001768281u, 2395555655u, 4211863792u, 1106029997u, 3009926356u, 1610457762u, 1173008303u, 599760028u, 1408738468u,
            3835064946u, 2606481600u, 1975695287u, 3776773629u, 1034851219u, 1282024998u, 1817851446u, 2118205247u, 4110612471u, 2203045068u,
            1750873140u, 1374987685u, 3509904869u, 4178113009u, 3801313649u, 2876496088u, 1649619249u, 708777237u, 135005188u, 2505230279u,
            1181033251u, 2640233411u, 807933976u, 933336726u, 168756485u, 800430746u, 235472647u, 607523346u, 463175808u, 3745374946u,
            3441880043u, 1315514151u, 2144187058u, 3936318837u, 303761673u, 496927619u, 1484008492u, 875436570u, 908925723u, 3702681198u,
            3035519578u, 1543217312u, 2767606354u, 1984772923u, 3076642518u, 2110698419u, 1383803177u, 3711886307u, 1584475951u, 328696964u,
            2801095507u, 3110654417u, 0u, 3240947181u, 1080041504u, 3810524412u, 2043195825u, 3069008731u, 3569248874u, 2370227147u,
            1742323390u, 1917532473u, 2497595978u, 2564049996u, 2968016984u, 2236272591u, 3144405200u, 3307925487u, 1340451498u, 3977706491u,
            2261074755u, 2597801293u, 1716859699u, 294946181u, 2328839493u, 3910203897u, 67502594u, 4269899647u, 2700103760u, 2017737788u,
            632987551u, 1273211048u, 2733855057u, 1576969123u, 2160083008u, 92966799u, 1068339858u, 566009245u, 1883781176u, 4043634165u,
            1675607228u, 2009183926u, 2943736538u, 1113792801u, 540020752u, 3843751935u, 4245615603u, 3211645650u, 2169294285u, 403966988u,
            641012499u, 3274697964u, 3202441055u, 899848087u, 2295088196u, 775493399u, 2472002756u, 1441965991u, 4236410494u, 2051489085u,
            3366741092u, 3135724893u, 841685273u, 3868554099u, 3231735904u, 429425025u, 2664517455u, 2743065820u, 1147544098u, 1417554474u,
            1001099408u, 193169544u, 2362066502u, 3341414126u, 1809037496u, 675025940u, 2809781982u, 3168951902u, 371002123u, 2910247899u,
            3678134496u, 1683370546u, 1951283770u, 337512970u, 2463844681u, 201983494u, 1215046692u, 3101973596u, 2673722050u, 3178157011u,
            1139780780u, 3299238498u, 967348625u, 832869781u, 3543655652u, 4069226873u, 3576883175u, 2336475336u, 1851340599u, 3669454189u,
            25988493u, 2976175573u, 2631028302u, 1239460265u, 3635702892u, 2902087254u, 4077384948u, 3475368682u, 3400492389u, 4102978170u,
            1206496942u, 270010376u, 1876277946u, 4035475576u, 1248797989u, 1550986798u, 941890588u, 1475454630u, 1942467764u, 2538718918u,
            3408128232u, 2709315037u, 3902567540u, 1042358047u, 2531085131u, 1641856445u, 226921355u, 260409994u, 3767562352u, 2084716094u,
            1908716981u, 3433719398u, 2430093384u, 100991747u, 4144101110u, 470945294u, 3265487201u, 1784624437u, 2935576407u, 1775286713u,
            395413126u, 2572730817u, 975641885u, 666476190u, 3644383713u, 3943954680u, 733190296u, 573772049u, 3535497577u, 2842745305u,
            126455438u, 866620564u, 766942107u, 1008868894u, 361924487u, 3374377449u, 2269761230u, 2868860245u, 1350051880u, 2776293343u,
            59739276u, 1509466529u, 159418761u, 437718285u, 1708834751u, 3610371814u, 2227585602u, 3501746280u, 2193834305u, 699439513u,
            1517759789u, 504434447u, 2076946608u, 2835108948u, 1842789307u, 742004246u
        },
        {
            1673962851u, 2096661628u, 2012125559u, 2079755643u, 4076801522u, 1809235307u, 1876865391u, 3314635973u, 811618352u, 16909057u,
            1741597031u, 727088427u, 4276558334u, 3618988759u, 2874009259u, 1995217526u, 3398387146u, 2183110018u, 3381215433u, 2113570685u,
            4209972730u, 1504897881u, 1200539975u, 4042984432u, 2906778797u, 3568527316u, 2724199842u, 2940594863u, 2619588508u, 2756966308u,
            1927583346u, 3231407040u, 3077948087u, 4259388669u, 2470293139u, 642542118u, 913070646u, 1065238847u, 4160029431u, 3431157708u,
            879254580u, 2773611685u, 3855693029u, 4059629809u, 1910674289u, 3635114968u, 828527409u, 355090197u, 67636228u, 3348452039u,
            591815971u, 3281870531u, 405809176u, 2520228246u, 84545285u, 2586817946u, 118360327u, 304363026u, 2149292928u, 3806281186u,
            3956090603u, 659450151u, 2994720178u, 1978310517u, 152181513u, 2199756419u, 743994412u, 439627290u, 456535323u, 1859957358u,
            1521806938u, 2690382752u, 1386542674u, 997608763u, 3602342358u, 3011366579u, 693271337u, 3822927587u, 794718511u, 2215876484u,
            1403450707u, 3518589137u, 0u, 3988860141u, 541089824u, 4242743292u, 2977548465u, 1538714971u, 1792327274u, 3415033547u,
            3194476990u, 963791673u, 1251270218u, 1285084236u, 1487988824u, 3481619151u, 3501943760u, 4022676207u, 2857362858u, 4226619131u,
            1132905795u, 1301993293u, 862344499u, 2232521861u, 1166724933u, 4192801017u, 33818114u, 2147385727u, 1352724560u, 1014514748u,
            2670049951u, 2823545768u, 1369633617u, 2740846243u, 1082179648u, 2399505039u, 2453646738u, 2636233885u, 946882616u, 4126213365u,
            3160661948u, 3061301686u, 3668932058u, 557998881u, 270544912u, 4293204735u, 4093447923u, 3535760850u, 3447803085u, 202904588u,
            321271059u, 3972214764u, 1606345055u, 2536874647u, 1149815876u, 388905239u, 3297990596u, 2807427751u, 2130477694u, 1031423805u,
            1690872932u, 1572530013u, 422718233u, 1944491379u, 1623236704u, 2165938305u, 1335808335u, 3701702620u, 574907938u, 710180394u,
            2419829648u, 2282455944u, 1183631942u, 4006029806u, 3094074296u, 338181140u, 3735517662u, 1589437022u, 185998603u, 3685578459u,
            3772464096u, 845436466u, 980700730u, 169090570u, 1234361161u, 101452294u, 608726052u, 1555620956u, 3265224130u, 3552407251u,
            2890133420u, 1657054818u, 2436475025u, 2503058581u, 3839047652u, 2045938553u, 3889509095u, 3364570056u, 929978679u, 1843050349u,
            2365688973u, 3585172693u, 1318900302u, 2840191145u, 1826141292u, 1454176854u, 4109567988u, 3939444202u, 1707781989u, 2062847610u,
            2923948462u, 135272456u, 3127891386u, 2029029496u, 625635109u, 777810478u, 473441308u, 2790781350u, 3027486644u, 3331805638u,
            3905627112u, 3718347997u, 1961401460u, 524165407u, 1268178251u, 3177307325u, 2332919435u, 2316273034u, 1893765232u, 1048330814u,
            3044132021u, 1724688998u, 1217452104u, 50726147u, 4143383030u, 236720654u, 1640145761u, 896163637u, 1471084887u, 3110719673u,
            2249691526u, 3248052417u, 490350365u, 2653403550u, 3789109473u, 4176155640u, 2553000856u, 287453969u, 1775418217u, 3651760345u,
            2382858638u, 2486413204u, 2603464347u, 507257374u, 2266337927u, 3922272489u, 3464972750u, 1437269845u, 676362280u, 3752164063u,
            2349043596u, 2707028129u, 2299101321u, 219813645u, 3211123391u, 3872862694u, 1115997762u, 1758509160u, 1099088705u, 2569646233u,
            760903469u, 253628687u, 2960903088u, 1420360788u, 3144537787u, 371997206u
        },
        {
            1667483301u, 2088564868u, 2004348569u, 2071721613u, 4076011277u, 1802229437u, 1869602481u, 3318059348u, 808476752u, 16843267u,
            1734856361u, 724260477u, 4278118169u, 3621238114u, 2880130534u, 1987505306u, 3402272581u, 2189565853u, 3385428288u, 2105408135u,
            4210749205u, 1499050731u, 1195871945u, 4042324747u, 2913812972u, 3570709351u, 2728550397u, 2947499498u, 2627478463u, 2762232823u,
            1920132246u, 3233848155u, 3082253762u, 4261273884u, 2475900334u, 640044138u, 909536346u, 1061125697u, 4160222466u, 3435955023u,
            875849820u, 2779075060u, 3857043764u, 4059166984u, 1903288979u, 3638078323u, 825320019u, 353708607u, 67373068u, 3351745874u,
            589514341u, 3284376926u, 404238376u, 2526427041u, 84216335u, 2593796021u, 117902857u, 303178806u, 2155879323u, 3806519101u,
            3958099238u, 656887401u, 2998042573u, 1970662047u, 151589403u, 2206408094u, 741103732u, 437924910u, 454768173u, 1852759218u,
            1515893998u, 2694863867u, 1381147894u, 993752653u, 3604395873u, 3014884814u, 690573947u, 3823361342u, 791633521u, 2223248279u,
            1397991157u, 3520182632u, 0u, 3991781676u, 538984544u, 4244431647u, 2981198280u, 1532737261u, 1785386174u, 3419114822u,
            3200149465u, 960066123u, 1246401758u, 1280088276u, 1482207464u, 3486483786u, 3503340395u, 4025468202u, 2863288293u, 4227591446u,
            1128498885u, 1296931543u, 859006549u, 2240090516u, 1162185423u, 4193904912u, 33686534u, 2139094657u, 1347461360u, 1010595908u,
            2678007226u, 2829601763u, 1364304627u, 2745392638u, 1077969088u, 2408514954u, 2459058093u, 2644320700u, 943222856u, 4126535940u,
            3166462943u, 3065411521u, 3671764853u, 555827811u, 269492272u, 4294960410u, 4092853518u, 3537026925u, 3452797260u, 202119188u,
            320022069u, 3974939439u, 1600110305u, 2543269282u, 1145342156u, 387395129u, 3301217111u, 2812761586u, 2122251394u, 1027439175u,
            1684326572u, 1566423783u, 421081643u, 1936975509u, 1616953504u, 2172721560u, 1330618065u, 3705447295u, 572671078u, 707417214u,
            2425371563u, 2290617219u, 1179028682u, 4008625961u, 3099093971u, 336865340u, 3739133817u, 1583267042u, 185275933u, 3688607094u,
            3772832571u, 842163286u, 976909390u, 168432670u, 1229558491u, 101059594u, 606357612u, 1549580516u, 3267534685u, 3553869166u,
            2896970735u, 1650640038u, 2442213800u, 2509582756u, 3840201527u, 2038035083u, 3890730290u, 3368586051u, 926379609u, 1835915959u,
            2374828428u, 3587551588u, 1313774802u, 2846444000u, 1819072692u, 1448520954u, 4109693703u, 3941256997u, 1701169839u, 2054878350u,
            2930657257u, 134746136u, 3132780501u, 2021191816u, 623200879u, 774790258u, 471611428u, 2795919345u, 3031724999u, 3334903633u,
            3907570467u, 3722289532u, 1953818780u, 522141217u, 1263245021u, 3183305180u, 2341145990u, 2324303749u, 1886445712u, 1044282434u,
            3048567236u, 1718013098u, 1212715224u, 50529797u, 4143380225u, 235805714u, 1633796771u, 892693087u, 1465364217u, 3115936208u,
            2256934801u, 3250690392u, 488454695u, 2661164985u, 3789674808u, 4177062675u, 2560109491u, 286335539u, 1768542907u, 3654920560u,
            2391672713u, 2492740519u, 2610638262u, 505297954u, 2273777042u, 3924412704u, 3469641545u, 1431677695u, 673730680u, 3755976058u,
            2357986191u, 2711706104u, 2307459456u, 218962455u, 3216991706u, 3873888049u, 1111655622u, 1751699640u, 1094812355u, 2576951728u,
            757946999u, 252648977u, 2964356043u, 1414834428u, 3149622742u, 370551866u
        },
        {
            2774754246u, 2222750968u, 2574743534u, 2373680118u, 234025727u, 3177933782u, 2976870366u, 1422247313u, 1345335392u, 50397442u,
            2842126286u, 2099981142u, 436141799u, 1658312629u, 3870010189u, 2591454956u, 1170918031u, 2642575903u, 1086966153u, 2273148410u,
            368769775u, 3948501426u, 3376891790u, 200339707u, 3970805057u, 1742001331u, 4255294047u, 3937382213u, 3214711843u, 4154762323u,
            2524082916u, 1539358875u, 3266819957u, 486407649u, 2928907069u, 1780885068u, 1513502316u, 1094664062u, 49805301u, 1338821763u,
            1546925160u, 4104496465u, 887481809u, 150073849u, 2473685474u, 1943591083u, 1395732834u, 1058346282u, 201589768u, 1388824469u,
            1696801606u, 1589887901u, 672667696u, 2711000631u, 251987210u, 3046808111u, 151455502u, 907153956u, 2608889883u, 1038279391u,
            652995533u, 1764173646u, 3451040383u, 2675275242u, 453576978u, 2659418909u, 1949051992u, 773462580u, 756751158u, 2993581788u,
            3998898868u, 4221608027u, 4132590244u, 1295727478u, 1641469623u, 3467883389u, 2066295122u, 1055122397u, 1898917726u, 2542044179u,
            4115878822u, 1758581177u, 0u, 753790401u, 1612718144u, 536673507u, 3367088505u, 3982187446u, 3194645204u, 1187761037u,
            3653156455u, 1262041458u, 3729410708u, 3561770136u, 3898103984u, 1255133061u, 1808847035u, 720367557u, 3853167183u, 385612781u,
            3309519750u, 3612167578u, 1429418854u, 2491778321u, 3477423498u, 284817897u, 100794884u, 2172616702u, 4031795360u, 1144798328u,
            3131023141u, 3819481163u, 4082192802u, 4272137053u, 3225436288u, 2324664069u, 2912064063u, 3164445985u, 1211644016u, 83228145u,
            3753688163u, 3249976951u, 1977277103u, 1663115586u, 806359072u, 452984805u, 250868733u, 1842533055u, 1288555905u, 336333848u,
            890442534u, 804056259u, 3781124030u, 2727843637u, 3427026056u, 957814574u, 1472513171u, 4071073621u, 2189328124u, 1195195770u,
            2892260552u, 3881655738u, 723065138u, 2507371494u, 2690670784u, 2558624025u, 3511635870u, 2145180835u, 1713513028u, 2116692564u,
            2878378043u, 2206763019u, 3393603212u, 703524551u, 3552098411u, 1007948840u, 2044649127u, 3797835452u, 487262998u, 1994120109u,
            1004593371u, 1446130276u, 1312438900u, 503974420u, 3679013266u, 168166924u, 1814307912u, 3831258296u, 1573044895u, 1859376061u,
            4021070915u, 2791465668u, 2828112185u, 2761266481u, 937747667u, 2339994098u, 854058965u, 1137232011u, 1496790894u, 3077402074u,
            2358086913u, 1691735473u, 3528347292u, 3769215305u, 3027004632u, 4199962284u, 133494003u, 636152527u, 2942657994u, 2390391540u,
            3920539207u, 403179536u, 3585784431u, 2289596656u, 1864705354u, 1915629148u, 605822008u, 4054230615u, 3350508659u, 1371981463u,
            602466507u, 2094914977u, 2624877800u, 555687742u, 3712699286u, 3703422305u, 2257292045u, 2240449039u, 2423288032u, 1111375484u,
            3300242801u, 2858837708u, 3628615824u, 84083462u, 32962295u, 302911004u, 2741068226u, 1597322602u, 4183250862u, 3501832553u,
            2441512471u, 1489093017u, 656219450u, 3114180135u, 954327513u, 335083755u, 3013122091u, 856756514u, 3144247762u, 1893325225u,
            2307821063u, 2811532339u, 3063651117u, 572399164u, 2458355477u, 552200649u, 1238290055u, 4283782570u, 2015897680u, 2061492133u,
            2408352771u, 4171342169u, 2156497161u, 386731290u, 3669999461u, 837215959u, 3326231172u, 3093850320u, 3275833730u, 2962856233u,
            1999449434u, 286199582u, 3417354363u, 4233385128u, 3602627437u, 974525996u
        },
        {
            0u, 403652813u, 807305267u, 672252158u, 1614588262u, 2016668075u, 1344416085u, 1210935704u, 3229154252u, 3631725313u,
            4033248255u, 3899210546u, 2688832170u, 3091927655u, 2421871257u, 2287309396u, 703618865u, 838803452u, 435085058u, 31563727u,
            1238169175u, 1371780762u, 2043836004u, 1641887401u, 3918046461u, 4052214832u, 3650495694u, 3248055299u, 2310278555u, 2444971350u,
            3114962344u, 2711997797u, 1380564578u, 1246166703u, 1649884753u, 2052619932u, 846534404u, 712660937u, 40605495u, 442816506u,
            2452702638u, 2319320419u, 2721039773u, 3122693456u, 4060998856u, 3926043653u, 3256052987u, 3659279414u, 2075779411u, 1672913310u,
            1269260640u, 1403527597u, 461719605u, 59377912u, 731629574u, 865372363u, 3149994655u, 2748209746u, 2346687148u, 2479938145u,
            3690836985u, 3287479092u, 3957535690u, 4092359431u, 2761086404u, 3164443913u, 2492225015u, 2357400890u, 3299769506u, 3701554287u,
            4105239697u, 3971988572u, 1693068808u, 2095410885u, 1425321531u, 1291579126u, 81168238u, 484034467u, 885524317u, 751257488u,
            2372045557u, 2507000376u, 3179023046u, 2775796235u, 3982369683u, 4115751774u, 3712000928u, 3310347117u, 1293578553u, 1427452404u,
            2097475850u, 1695265223u, 757520479u, 891918482u, 490231916u, 87496865u, 4141575078u, 4006882155u, 3334859669u, 3737824088u,
            2531771072u, 2397602317u, 2801353459u, 3203793470u, 916689002u, 783077543u, 113053785u, 515002516u, 1453275404u, 1318091201u,
            1719777599u, 2123299314u, 3744150679u, 3341055066u, 4013274276u, 4147836009u, 3205996017u, 2803424572u, 2399739330u, 2533776655u,
            525586267u, 123506582u, 793595752u, 927076261u, 2138007101u, 1734354672u, 1332864526u, 1467918019u, 3784114977u, 4186063852u,
            3516105490u, 3382494175u, 2175904327u, 2579425930u, 2981046900u, 2845862585u, 569768173u, 972732448u, 300644574u, 165951507u,
            1103712651u, 1506152774u, 1909969336u, 1775800693u, 3363658768u, 3497139421u, 4167293987u, 3765214446u, 2822894966u, 2957948347u,
            2556392773u, 2152740232u, 134588380u, 269149969u, 941303791u, 538208034u, 1748569786u, 1882607223u, 1478987401u, 1076416068u,
            3016015171u, 2882272654u, 2212117872u, 2614459837u, 3556250661u, 3421983976u, 3823539222u, 4226405595u, 1941718671u, 1806894658u,
            1134741180u, 1538098801u, 327217129u, 193965860u, 597585882u, 999370519u, 2587157106u, 2184946367u, 2854904385u, 2988778124u,
            4194847508u, 3792112601u, 3390491431u, 3524889578u, 1514936766u, 1111710067u, 1783798157u, 1918753088u, 980463832u, 578809877u,
            174993643u, 308375590u, 1159714533u, 1561368104u, 1963022038u, 1829639707u, 623083395u, 1026309966u, 356384688u, 221429629u,
            2238131497u, 2640866788u, 3044650266u, 2910252503u, 3847980111u, 4250190978u, 3578070140u, 3444196529u, 1827637716u, 1960888601u,
            1559300583u, 1157515562u, 215163058u, 349986943u, 1020108929u, 616751180u, 2895606296u, 3029873365u, 2626286123u, 2223420134u,
            3433814910u, 3567557555u, 4239743821u, 3837401984u, 391538823u, 257501258u, 659089588u, 1061660793u, 2003485153u, 1868923180u,
            1198801362u, 1601896735u, 3610153803u, 3475100550u, 3878687608u, 4282340277u, 3071425069u, 2937944800u, 2265758238u, 2667838163u,
            1051080630u, 648640379u, 246986629u, 381155144u, 1587191504u, 1184226845u, 1854152419u, 1988845102u, 4276014202u, 3872492727u,
            3468708937u, 3603893380u, 2665637148u, 2263688657u, 2935809327u, 3069421026u
        },
        {
            0u, 3785346835u, 1805072166u, 2315843637u, 3599199820u, 924361055u, 3171965290u, 1552914041u, 94887064u, 3828880267u,
            1848699838u, 2410620077u, 3542135508u, 851410375u, 3099035122u, 1495812833u, 182915481u, 3950567050u, 1634739903u, 2163206572u,
            3697311701u, 1040167110u, 3086436595u, 1449691104u, 255905025u, 4007592466u, 1691875879u, 2236101940u, 3653739341u, 945319006u,
            2991625323u, 1406098296u, 342303387u, 4126731656u, 2146440637u, 2658130606u, 3269479639u, 595559364u, 2843180017u, 1223210210u,
            297860611u, 4032770320u, 2052573477u, 2613577270u, 3343355983u, 651714396u, 2899355497u, 1297049722u, 511718146u, 4280286225u,
            1964442660u, 2491992887u, 3355925838u, 697864797u, 2744150632u, 1108321659u, 455602074u, 4206370953u, 1890638012u, 2435782575u,
            3449848278u, 742346437u, 2788669168u, 1202223587u, 684606623u, 3377564556u, 1129935801u, 2730933418u, 4266207955u, 534177216u,
            2514361845u, 1950470886u, 761894919u, 3438696212u, 1191096097u, 2808176690u, 4226741835u, 443627864u, 2423898477u, 1910902398u,
            573134086u, 3283524117u, 1237213728u, 2820779315u, 4105059146u, 355595353u, 2671316076u, 2124858239u, 663652766u, 3323020941u,
            1276755640u, 2911269291u, 4043958226u, 278276289u, 2594099444u, 2063671271u, 1017734660u, 3711346967u, 1463701794u, 3064045105u,
            3928885320u, 196200283u, 2176401262u, 1613164669u, 957266588u, 3633411471u, 1385795002u, 3003531945u, 4018787536u, 236329923u,
            2216616950u, 1702964453u, 911112093u, 3620845710u, 1574518971u, 3158740904u, 3771275729u, 22468290u, 2338205431u, 1791091172u,
            870951685u, 3530974230u, 1484692515u, 3118551856u, 3849241929u, 82905690u, 2398745199u, 1868971388u, 1345685655u, 2980726660u,
            1000521649u, 3661459618u, 2259871451u, 1731013064u, 3978678781u, 213524206u, 1435653135u, 3020790556u, 1040540457u, 3751455802u,
            2199206467u, 1653273936u, 3900837221u, 152945270u, 1523751182u, 3142407709u, 826650152u, 3503972667u, 2354444098u, 1841969233u,
            3888300132u, 106762103u, 1601521046u, 3203041925u, 887255728u, 3581787555u, 2314349530u, 1752032457u, 3798277372u, 66769903u,
            1146268172u, 2781701407u, 801479978u, 3462025785u, 2463482944u, 1934232403u, 4181914470u, 417152117u, 1106605716u, 2691348871u,
            711082418u, 3422391969u, 2540837080u, 1995298763u, 4242878462u, 494592237u, 1320532885u, 2938795142u, 623021235u, 3300737952u,
            2553468377u, 2041387722u, 4087735039u, 305802732u, 1259497229u, 2861410334u, 545607723u, 3239747384u, 2643790145u, 2081080914u,
            4127342183u, 396226932u, 2029767688u, 2573468443u, 325909294u, 4076024893u, 2927403588u, 1340304727u, 3320550754u, 611605105u,
            2103185552u, 2630082435u, 382412726u, 4149536933u, 2883288796u, 1246015951u, 3226225146u, 567510761u, 1914494353u, 2474840706u,
            428599991u, 4162069924u, 2761667549u, 1157921998u, 3473704187u, 781405160u, 2008744201u, 2518994458u, 472659503u, 4256430396u,
            2705092421u, 1084465238u, 3400226915u, 724866928u, 1822224019u, 2365792640u, 118217141u, 3868464806u, 3122364639u, 1535397836u,
            3515660281u, 806582506u, 1765487115u, 2292514072u, 44827949u, 3811822142u, 3216792647u, 1579389780u, 3559615329u, 901031026u,
            1719402250u, 2279878681u, 233621548u, 3966961471u, 2969342278u, 1365466709u, 3681265248u, 989096307u, 1675371410u, 2185489537u,
            139138228u, 3923041191u, 3042659806u, 1422164685u, 3737942776u, 1062450667u
        }
    };

    public void Refresh()
    {
        for (int i = 0; i < 16; i++)
        {
            int num = ((124 - (i << 2)) & 0x3F) >> 2;
            int num2 = ((80 - (i << 2)) & 0x3F) >> 2;
            int num3 = num;
            int num4 = ((116 - (i << 2)) & 0x3F) >> 2;
            int num5 = num2;
            int num6 = 19;
            int num7 = ((104 - (i << 2)) & 0x3F) >> 2;
            int num8 = 18;
            int num9 = ((120 - (i << 2)) & 0x3F) >> 2;
            int num10 = num;
            int num11 = 18;
            int num12 = 19;
            setFourVar(ref var_0[num10], ref var_0[num11], ref var_0[num12], ref var_1[i], var_0[num], var_0[num2], var_0[num3], var_0[num5], var_0[num4], var_0[num6], var_0[num7], var_0[num8], var_0[num9]);
        }

        curSubPos = 0;
    }

    private byte[] getInitHeaderArr(string filename, string anotherData)
    {
        filename = filename.ToLower();
        string s = filename + anotherData;
        byte[] bytes = Encoding.GetEncoding("UTF-16").GetBytes(s);
        byte[] array = new byte[128];
        int num = bytes.Length >> 1;
        for (int i = 0; i < 128; i++)
        {
            int num2 = i % num;
            array[i] = (byte)(bytes[num2 * 2] + i);
        }

        return array;
    }

    private byte[] getInitFilesInfoArr(string filename, string anotherData)
    {
        filename = filename.ToLower();
        string text = filename + anotherData;
        byte[] bytes = Encoding.GetEncoding("UTF-16").GetBytes(text);
        byte[] array = new byte[128];
        int num = bytes.Length >> 1;
        for (int i = 0; i < 128; i++)
        {
            int num2 = i % num;
            int num3 = (int)((long)i * 1431655766L >> 32);
            num3 = (num3 >> 31) + num3;
            num3 = (byte)((byte)i - (byte)(num3 * 3) + 2);
            array[i] = (byte)(bytes[(text.Length - num2 - 1) * 2] * num3 + i);
        }

        return array;
    }

    private byte[] getInitFileDataArr(string filename, byte[] key, int u2)
    {
        return null;
    }

    public void InitFromKey(byte[] key)
    {
        var_0 = new uint[20];
        var_1 = new uint[16];
        for (int i = 0; i < 4; i++)
        {
            uint num = 0u;
            for (int j = 0; j < 4; j++)
            {
                num = (num << 8) | (uint)(sbyte)key[(i << 2) + j];
            }

            var_0[i] = (var_0[i + 8] = num);
            var_0[i + 4] = (var_0[i + 12] = ~num);
        }

        uint[] array = new uint[21]
        {
            var_0[0],
            var_0[8],
            var_0[1],
            var_0[9],
            var_0[2],
            var_0[10],
            var_0[3],
            var_0[4],
            var_0[5],
            var_0[7],
            var_0[14],
            var_0[11],
            var_0[6],
            var_0[12],
            var_0[15],
            var_0[13],
            0u,
            var_0[13],
            0u,
            2u,
            0u
        };
        int num2 = 2;
        do
        {
            uint num3 = 0u;
            uint num4 = 0u;
            uint num5 = (array[16] + array[0]) ^ array[18];
            array[18] += array[5];
            num4 = getConst(5, array[14]) ^ getConst(4, array[7]);
            num4 ^= (array[14] << 8) ^ (array[7] >> 8) ^ array[17] ^ num3 ^ num5;
            array[14] = num4;
            num5 = array[14] + array[18];
            setTwoVar(ref array[10], ref array[16], array[16], array[6], array[13], array[3], ref num5);
            setTwoVar(ref array[15], ref array[17], array[18], array[4], array[11], array[1], ref num5);
            setTwoVar(ref array[13], ref var_0[18], array[16], array[2], array[5], array[9], ref num5);
            setTwoVar_spec(ref array[11], ref var_0[18], array[17], array[0], array[3], array[12], ref num5, ref array[18], ref var_0[18]);
            setTwoVar(ref array[5], ref array[18], array[18], array[14], array[1], array[8], ref num5);
            setTwoVar_spec(ref array[3], ref array[18], var_0[18], array[10], array[9], array[7], ref num5, ref var_0[18], ref array[18]);
            setTwoVar_spec(ref array[1], ref array[18], var_0[18], array[15], array[12], array[6], ref num5, ref var_0[18], ref array[18]);
            setTwoVar_spec(ref array[9], ref array[18], var_0[18], array[13], array[8], array[4], ref num5, ref var_0[18], ref array[18]);
            setTwoVar_spec(ref array[12], ref array[18], var_0[18], array[11], array[7], array[2], ref num5, ref var_0[18], ref array[18]);
            setTwoVar_spec(ref array[8], ref array[18], var_0[18], array[5], array[6], array[0], ref num5, ref var_0[18], ref array[18]);
            setTwoVar_spec(ref array[7], ref array[18], var_0[18], array[3], array[4], array[14], ref num5, ref var_0[18], ref array[18]);
            setTwoVar_spec(ref array[6], ref array[18], var_0[18], array[1], array[2], array[10], ref num5, ref var_0[18], ref array[18]);
            setTwoVar_spec(ref array[4], ref array[16], var_0[18], array[9], array[0], array[15], ref num5, ref var_0[18], ref array[18]);
            setTwoVar(ref array[2], ref var_0[18], var_0[18], array[12], array[14], array[13], ref num5);
            array[20] = getConst03(array[16]) ^ num5;
            setTwoVar(ref array[0], ref array[16], array[16], array[8], array[10], array[11], ref num5);
            array[18] = getConst03(var_0[18]);
            array[19]--;
            var_0[18] = array[16];
            array[17] = array[15];
        }
        while (--num2 > 0);
        var_0[0] = array[0];
        var_0[8] = array[1];
        var_0[1] = array[2];
        var_0[9] = array[3];
        var_0[2] = array[4];
        var_0[10] = array[5];
        var_0[3] = array[6];
        var_0[11] = array[11];
        var_0[4] = array[7];
        var_0[5] = array[8];
        var_0[6] = array[12];
        var_0[7] = array[9];
        var_0[16] = array[20];
        var_0[15] = array[14];
        var_0[13] = array[15];
        var_0[17] = array[16];
        var_0[14] = array[10];
        var_0[19] = array[18];
        var_0[12] = array[13];
        curSubPos = 16;
    }

    public void InitHeaderKey(string filename, string anotherData)
    {
        InitFromKey(getInitHeaderArr(filename, anotherData));
    }

    public void InitFilesInfoKey(string filename, string anotherData)
    {
        InitFromKey(getInitFilesInfoArr(filename, anotherData));
    }

    private uint getConst03(uint number)
    {
        return getConst(0, number) ^ getConst(1, number) ^ getConst(2, number) ^ getConst(3, number);
    }

    private uint getConst(int index, uint number)
    {
        return index switch
        {
            0 => const_1[index, (number >> 24) & 0xFF],
            1 => const_1[index, (number >> 16) & 0xFF],
            2 => const_1[index, (number >> 8) & 0xFF],
            3 => const_1[index, number & 0xFF],
            4 => const_1[index, number & 0xFF],
            5 => const_1[index, (number >> 24) & 0xFF],
            _ => throw new Exception("getConstNum err."),
        };
    }

    private void setTwoVar(ref uint setVar, ref uint setVar2, uint numFs, uint numL, uint numC, uint numP, ref uint lastSum)
    {
        uint @const = getConst03(numFs);
        uint num = getConst(5, setVar) ^ getConst(4, numL);
        num ^= (setVar << 8) ^ (numL >> 8) ^ numC ^ @const ^ lastSum;
        setVar = num;
        setVar2 = numP + @const;
        lastSum = setVar + setVar2;
    }

    private void setTwoVar_spec(ref uint setVar, ref uint setVar2, uint numFs, uint numL, uint numC, uint numP, ref uint lastSum, ref uint dest, ref uint source)
    {
        uint @const = getConst03(numFs);
        dest = source;
        uint num = getConst(5, setVar) ^ getConst(4, numL);
        num ^= (setVar << 8) ^ (numL >> 8) ^ numC ^ @const ^ lastSum;
        setVar = num;
        setVar2 = numP + @const;
        lastSum = setVar + setVar2;
    }

    private void setFourVar(ref uint svar54, ref uint svarab, ref uint svar03, ref uint svarn, uint var5, uint var4, uint varL, uint varR, uint varC, uint varA, uint varB, uint var03, uint varOth)
    {
        uint num = getConst(5, var5) ^ getConst(4, var4) ^ (varL << 8) ^ varC ^ (varR >> 8);
        uint num2 = varA + varB;
        uint @const = getConst03(var03);
        uint num3 = (num + num2) ^ @const ^ varOth;
        svar54 = num;
        svarab = num2;
        svar03 = @const;
        svarn = num3;
    }

    public uint GetNextSubNum()
    {
        if (curSubPos == 16)
        {
            Refresh();
        }

        return var_1[curSubPos++];
    }
}